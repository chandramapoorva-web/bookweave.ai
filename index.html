<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>BookWeave.AI</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Role select overlay -->
  <div id="landing" class="landing">
    <div class="landing-card">
      <h1>BookWeave.AI</h1>
      <p class="muted">Choose your role to personalize your workspace</p>
      <label class="muted" for="roleSelect">I am</label>
      <select id="roleSelect">
        <option value="writer">Writer</option>
        <option value="journalist">Journalist</option>
        <option value="student">Student</option>
        <option value="other">Others</option>
      </select>
      <button id="continueBtn">Continue</button>
      <div class="muted tiny" style="margin-top:8px">You can change this later in Settings</div>
    </div>
  </div>

  <!-- App header -->
  <header>
    <div>
      <h1>BookWeave.AI</h1>
      <div class="tagline">Your story and notes stay on this device. Private and offline</div>
    </div>
    <div class="toolbar">
      <button id="themeToggle" class="ghost" aria-label="Toggle theme">ðŸŒ™</button>
      <button id="lockBtn" class="ghost" title="Lock with passcode">ðŸ”’</button>
    </div>
  </header>

  <!-- Lock screen overlay -->
  <div id="lockOverlay" class="lock-overlay" style="display:none">
    <div class="lock-card">
      <h3>Enter passcode</h3>
      <input id="lockInput" placeholder="Passcode" type="password" />
      <div class="row right">
        <button id="unlockBtn">Unlock</button>
      </div>
      <div class="status" id="lockStatus"></div>
    </div>
  </div>

  <main class="container">
    <!-- Left column: capture and entries -->
    <section class="card">
      <div class="section-title">Capture</div>
      <div class="row" style="align-items:center">
        <div class="rec" id="recBubble"><div class="dot" id="dot" style="opacity:.12"></div></div>
        <div class="toolbar">
          <button id="startBtn">Start Recording</button>
          <button class="secondary" id="stopBtn">Stop</button>
          <button class="ghost" id="micTest">Mic Test</button>
          <label class="switch"><input type="checkbox" id="autoTs"><span>Auto timestamps</span></label>
          <button class="ghost" id="markSpeakerA">Speaker A</button>
          <button class="ghost" id="markSpeakerB">Speaker B</button>
          <button class="ghost" id="flagBtn">Flag</button>
        </div>
      </div>
      <div class="status" id="recStatus">Use the device speech engine if available. You can also type below</div>
      <textarea id="transcript" rows="6" placeholder="Speak or type your entry here" spellcheck="true"></textarea>

      <div class="row">
        <button id="audioRecBtn">Start Audio Capture</button>
        <button id="audioStopBtn" class="secondary">Stop Audio</button>
        <button id="audioDownloadBtn" class="ghost">Download Audio</button>
      </div>
      <audio id="audioPlayer" controls style="width:100%; display:none"></audio>

      <div class="row right" style="margin-top:8px">
        <input id="entryTitle" placeholder="Optional title for this entry" />
        <select id="entryTag" style="max-width:180px"></select>
        <button id="saveEntry">Save Entry</button>
      </div>

      <hr />
      <div class="section-title">Entries</div>
      <div class="row" style="margin-bottom:8px">
        <input id="searchBox" placeholder="Search entries" />
        <select id="filterTag" style="max-width:180px"></select>
        <select id="sortOrder" style="max-width:180px">
          <option value="desc">Newest first</option>
          <option value="asc">Oldest first</option>
        </select>
      </div>
      <div class="list" id="entriesList"></div>
    </section>

    <!-- Right column: views and tools -->
    <section class="card">
      <div class="tabs">
        <button class="active" data-tab="compile" id="tabCompile">Compile and Export</button>
        <button data-tab="edit" id="tabEdit">Edit Selected</button>
        <button data-tab="calendar" id="tabCalendar">Calendar</button>
        <button data-tab="tools" id="tabTools">Tools</button>
        <button data-tab="dashboard" id="tabDash">Dashboard</button>
        <button data-tab="settings" id="tabSettings">Settings</button>
      </div>

      <!-- Compile view -->
      <div id="compileView">
        <h3 class="section-title">Manuscript Preview</h3>
        <div class="status" id="countStats"></div>
        <textarea id="manuscript" rows="16" placeholder="Compiled manuscript appears here"></textarea>
        <div class="row right" style="margin-top:8px">
          <button class="secondary" id="compileBtn">Compile All</button>
          <select id="compileTagOnly" style="max-width:200px"></select>
          <button id="compileByTagBtn" class="ghost">Compile by Tag</button>
        </div>
        <div class="row right" style="margin-top:8px">
          <button id="downloadTxt">TXT</button>
          <button id="downloadPdf">PDF</button>
          <button id="downloadDocx">DOCX</button>
          <button id="downloadEpub">EPUB</button>
          <button id="exportPptx">PPTX Outline</button>
        </div>
        <div class="row" style="margin-top:8px">
          <button id="summarizeBtn" class="ghost">Summarize</button>
          <div id="summaryBox" class="status" style="flex:1"></div>
        </div>
        <div class="status" id="progressStats"></div>
      </div>

      <!-- Edit view -->
      <div id="editView" style="display:none">
        <h3 class="section-title">Edit Entry</h3>
        <input id="editTitle" placeholder="Entry title" />
        <div class="row" style="margin:6px 0">
          <span class="chip" id="editDate"></span>
          <select id="editTag" style="max-width:160px"></select>
        </div>
        <textarea id="editBody" rows="14"></textarea>
        <div class="row right" style="margin-top:8px">
          <button class="secondary" id="saveEdit">Save Changes</button>
          <button class="ghost" id="deleteEdit">Delete Entry</button>
        </div>
      </div>

      <!-- Calendar view -->
      <div id="calendarView" style="display:none">
        <h3 class="section-title">Writing Calendar</h3>
        <div id="calendarControls" class="row" style="justify-content:space-between; margin-bottom:8px">
          <button class="ghost" id="prevMonth" aria-label="Previous month">â—€</button>
          <div id="calendarTitle" class="section-title"></div>
          <button class="ghost" id="nextMonth" aria-label="Next month">â–¶</button>
        </div>
        <div id="calendarGrid" class="calendar"></div>
      </div>

      <!-- Tools view -->
      <div id="toolsView" style="display:none">
        <h3 class="section-title">Offline Tools</h3>

        <details open>
          <summary><b>Keyword analyzer</b></summary>
          <div class="row"><button id="analyzeKeywords">Analyze</button></div>
          <div id="keywordsBox" class="mono"></div>
        </details>

        <details>
          <summary><b>Thesaurus and synonyms</b></summary>
          <div class="row">
            <input id="synInput" placeholder="Word" style="max-width:200px" />
            <button id="synBtn">Find synonyms</button>
          </div>
          <div id="synOut" class="mono"></div>
        </details>

        <details>
          <summary><b>Redaction</b></summary>
          <div class="row">
            <input id="redactWord" placeholder="Word to redact" style="max-width:220px" />
            <button id="redactInEdit">Redact in Edit</button>
            <button id="redactInCompiled" class="ghost">Redact in Manuscript</button>
          </div>
        </details>

        <details>
          <summary><b>Citation helper</b></summary>
          <div class="grid2">
            <input id="citAuthor" placeholder="Author" />
            <input id="citYear" placeholder="Year" />
            <input id="citTitle" placeholder="Title" />
            <input id="citSource" placeholder="Journal or Publisher" />
          </div>
          <div class="row">
            <button id="citAPA">APA</button>
            <button id="citHarvard" class="secondary">Harvard</button>
          </div>
          <div id="citOut" class="mono"></div>
        </details>

        <details>
          <summary><b>Flashcards</b></summary>
          <div class="row">
            <input id="fcQ" placeholder="Question" />
            <input id="fcA" placeholder="Answer" />
            <button id="fcAdd">Add</button>
            <button id="fcClear" class="ghost">Clear</button>
          </div>
          <div id="fcList" class="mono"></div>
          <div class="row" style="margin-top:8px">
            <button id="quizStart">Quiz me</button>
            <div id="quizBox" class="mono" style="flex:1"></div>
          </div>
        </details>

        <details>
          <summary><b>Glossary from manuscript</b></summary>
          <div class="row"><button id="buildGlossary">Build glossary</button></div>
          <div id="glossaryBox" class="mono"></div>
        </details>

        <details>
          <summary><b>Checklist</b></summary>
          <div class="row">
            <input id="todoInput" placeholder="Add checklist item" />
            <button id="todoAdd">Add</button>
          </div>
          <div id="todoList"></div>
        </details>
      </div>

      <!-- Dashboard view -->
      <div id="dashView" style="display:none">
        <h3 class="section-title">Statistics</h3>
        <div class="grid2">
          <div class="box">
            <div class="muted">Words total</div>
            <div id="statWords" class="big"></div>
          </div>
          <div class="box">
            <div class="muted">Estimated read time</div>
            <div id="statRead" class="big"></div>
          </div>
        </div>
        <h4>Words by tag</h4>
        <div id="byTag" class="mono"></div>
        <h4>Entries by day</h4>
        <div id="byDay" class="mono"></div>
      </div>

      <!-- Settings view -->
      <div id="settingsView" style="display:none">
        <h3 class="section-title">Settings</h3>

        <details open>
          <summary><b>Role and defaults</b></summary>
          <div class="row">
            <select id="roleChange">
              <option value="writer">Writer</option>
              <option value="journalist">Journalist</option>
              <option value="student">Student</option>
              <option value="other">Others</option>
            </select>
            <button id="applyRole">Apply</button>
          </div>
          <div class="status">Role controls starter tag sets and some tool defaults</div>
        </details>

        <details>
          <summary><b>Tags manager</b></summary>
          <div class="row">
            <input id="newTagInput" placeholder="New tag" />
            <button id="addTagBtn">Add</button>
          </div>
          <div id="tagsList" class="mono"></div>
        </details>

        <details>
          <summary><b>Passcode lock</b></summary>
          <div class="row">
            <input id="lockSetInput" type="password" placeholder="New passcode" />
            <button id="setPassBtn">Set passcode</button>
            <button id="clearPassBtn" class="ghost">Clear passcode</button>
          </div>
          <div class="status">This protects on this device only</div>
        </details>

        <details>
          <summary><b>Text and theme</b></summary>
          <div class="row">
            <label class="switch"><input id="spellToggle" type="checkbox" checked><span>Spellcheck in editor</span></label>
            <button id="fontSm" class="ghost">A</button>
            <button id="fontMd" class="ghost">A A</button>
            <button id="fontLg" class="ghost">A A A</button>
          </div>
        </details>
      </div>
    </section>
  </main>

  <div class="footer">Tip. Add to your home screen for a native feel. Data stays in your browser on this device</div>

  <!-- Client side libs for export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/8.2.4/docx.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PptxGenJS/3.12.0/pptxgen.bundle.js"></script>
  <script src="app.js"></script>
</body>
</html>
